(()=>{"use strict";var t={109:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TagManager=e.Tag=void 0;const i=new(n(337).TagParser)("stopwatch",{id:{tagName:"id",innerType:"string"},passed:{tagName:"passed",innerType:"integer"},limit:{tagName:"limit",innerType:"integer"},name:{tagName:"name",innerType:"string"},running:{tagName:"running",innerType:"yesno"}});class s{constructor(t,e,n){const{id:i,passed:s,limit:a,name:r,running:l}=e;this._id=null!=i?i:n.id,this._passed=null!=s?s:n.passed,this._limit=null!=a?a:n.limit,this._name=null!=r?r:n.name,this._running=null!=l?l:n.running,this._element=t}get id(){return this._id}get passed(){return this._passed}get limit(){return this._limit}get name(){return this._name}get running(){return this._running}get element(){return this._element}stringify(){var t,e;return null!==(e=null===(t=i.start(`stopwatch id:${this._id} passed:${this._passed} limit:${this._limit} name:${this._name} running:${this._running?"yes":"no"}`))||void 0===t?void 0:t.toString())&&void 0!==e?e:""}draw(){const t=document.createElement("span");t.addClass("inline-stopwatch-wrapper");const{button:e,setIcon:n}=this.buildButton(),{island:i,timeSpan:s,fill:a}=this.buildIsland(this,100);t.appendChild(e),t.appendChild(i),this._element.replaceWith(t)}buildButton(){const t=document.createElement("button");t.addClass("inline-stopwatch-button");const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttr("viewBox","0 0 16 16");const n=document.createElementNS("http://www.w3.org/2000/svg","path");e.appendChild(n),t.appendChild(e);const i=t=>n.setAttr("d",t?"M2 2h4v12H2zm8 0h4v12h-4z":"M3 2v12l10-6-10-6z");return i(!1),{button:t,setIcon:i}}buildIsland(t,e){const n=document.createElement("span");if(n.addClass("inline-stopwatch-island"),n.style.minWidth=`${e}px`,t.name){const e=document.createElement("span");e.addClass("inline-stopwatch-name"),e.textContent=t.name,n.appendChild(e)}const i=document.createElement("span");i.addClass("inline-stopwatch-time"),t.name&&i.addClass("inline-stopwatch-muted"),n.appendChild(i);const s=document.createElement("div");s.addClass("inline-stopwatch-timeline");const a=document.createElement("div");return a.addClass("inline-stopwatch-fill"),s.appendChild(a),n.appendChild(s),{island:n,timeSpan:i,fill:a}}}e.Tag=s,e.TagManager=class{constructor(){this.tags={},this.defaultTag={id:"1",passed:0,limit:60,name:"",running:!1}}parse(t){var e;const n=t.findAll("code");for(let t of n){const n=i.start(null!==(e=t.textContent)&&void 0!==e?e:"");if(n){n.id||(n.id=this.newId()),this.tags[n.id]&&(n.id=this.newId());const e=new s(t,n,this.defaultTag);return this.tags[n.id]=e,e}}return null}newId(){const t=Object.keys(this.tags);return 0===t.length?"1":(Math.max(...t.map(t=>parseInt(t,10)))+1).toString()}draw(){Object.values(this.tags).forEach(t=>{t.draw()})}write(){Object.values(this.tags).forEach(t=>{t.element.textContent=t.stringify()})}print(){console.log("Parsed tags:",this.tags)}}},197:t=>{t.exports=require("obsidian")},337:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TagParser=void 0,e.TagParser=class{constructor(t,e){this.blockName=t,this.structure=e,this.tagList=Object.values(e).map(t=>t.tagName)}start(t){const e=t.indexOf(this.blockName);if(-1===e)return null;let n=t.slice(e+this.blockName.length).trim();if(!n)return null;let i=[n];this.tagList.forEach(t=>{i=i.flatMap(e=>e.split(new RegExp(`(?=${t}\\s*:)`,"g")))}),i=i.filter(Boolean).map(t=>t.trim());const s={};return Object.entries(this.structure).forEach(([t,{tagName:e,innerType:n}])=>{const a=i.find(t=>t.startsWith(e));if(!a)return void(s[t]=null);const[,r=""]=a.split(/:(.+)/),l=r.trim();switch(n){case"integer":{const e=Number(l.replace(/\D+/g,""));s[t]=Number.isFinite(e)?e:null;break}case"yesno":{const e=l.toLowerCase();s[t]=!!e.includes("yes")||!e.includes("no")&&null;break}default:s[t]=l||null}}),s}}},927:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(s,a){function r(t){try{o(i.next(t))}catch(t){a(t)}}function l(t){try{o(i.throw(t))}catch(t){a(t)}}function o(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,l)}o((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const s=n(197),a=n(337),r=n(109);new a.TagParser("stopwatch",{id:{tagName:"id",innerType:"string"},passed:{tagName:"passed",innerType:"integer"},limit:{tagName:"limit",innerType:"integer"},name:{tagName:"name",innerType:"string"},running:{tagName:"running",innerType:"yesno"}});class l extends s.Plugin{onload(){return i(this,void 0,void 0,function*(){const t=new r.TagManager;this.registerMarkdownPostProcessor(e=>{var n;null===(n=t.parse(e))||void 0===n||n.draw()}),this.app.workspace.getActiveFile()&&t.print()})}}e.default=l}},e={},n=function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={exports:{}};return t[i].call(a.exports,a,a.exports,n),a.exports}(927);module.exports=n})();